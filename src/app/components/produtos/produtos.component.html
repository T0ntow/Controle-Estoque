<div id="box-filters">
  <ion-searchbar color="secondary" placeholder="Pesquise por um produto"
    (ionChange)="searchProducts($event)"></ion-searchbar>
  <ion-button color="secondary" id="popover-filters"> Filtros </ion-button>

  <ion-button color="secondary">
    <ion-select color="secondary" [(ngModel)]="sortOrder" (ionChange)="sortProducts()">
      <ion-select-option value="asc">Crescente</ion-select-option>
      <ion-select-option value="desc">Decrescente</ion-select-option>
    </ion-select>
  </ion-button>

  <ion-popover trigger="popover-filters">
    <ng-template>
      <ion-content>

        <ion-item color="dark">
          <ion-select placeholder="Marcas" [(ngModel)]="selectedMark" (ionChange)="filterProducts('mark')">
            <ion-select-option *ngFor="let marca of marcas" [value]="marca">{{ marca }}</ion-select-option>
          </ion-select>
        </ion-item>

        <ion-item color="dark">
          <ion-label>Data:</ion-label>

          <ion-input label="Data" type="date" labelPlacement="floating" placeholder="Data"
            (ionChange)="filterProducts('date')"></ion-input>
        </ion-item>

        <ion-item color="danger" button (click)="removeFilters()">Remover Filtros</ion-item>

      </ion-content>
    </ng-template>
  </ion-popover>
</div>

<main>
  <ion-grid class="table-container">
    <ion-row class="table-row">
      <ion-col class="table-col table-header">Produto</ion-col>
      <ion-col class="table-col table-header">Marca</ion-col>
      <ion-col class="table-col table-header">Data Inscricação</ion-col>
      <ion-col class="table-col table-header">Validade</ion-col>
      <ion-col class="table-col table-header">Estoque</ion-col>
      <ion-col class="table-col table-header">Entrada</ion-col>
      <ion-col class="table-col table-header">Saida</ion-col>
    </ion-row>
    <ion-row class="table-row" *ngFor="let product of products">
      <ion-col class="table-col">{{ product.nome }}</ion-col>
      <ion-col class="table-col">{{ product.marca }}</ion-col>
      <ion-col class="table-col">{{ formatarData(product.data_inscricao) }}</ion-col>
      <ion-col class="table-col">{{ formatarData(product.data_validade) }}</ion-col>
      <ion-col class="table-col">{{ product.estoque_inicial }}</ion-col>
      <ion-col class="table-col">{{ product.entrada }}</ion-col>
      <ion-col class="table-col">{{ product.saida}}</ion-col>
      <ion-col class="table-col ion-padding" id="edit-product" (click)="openPopoverEdit($event, product)">
        <ion-icon name="create-outline"></ion-icon>
      </ion-col>
    </ion-row>
  </ion-grid>
</main>

<ion-card *ngIf="errorGetProducts == true; ">
  <ion-title>Falha ao recuperar itens</ion-title>
</ion-card>

<ion-card *ngIf="products.length === 0">
  <ion-title>Sem produtos</ion-title>
</ion-card>